function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_unsupportedIterableToArray(r,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,a){var t;if(r)return"string"==typeof r?_arrayLikeToArray(r,a):"Map"===(t="Object"===(t={}.toString.call(r).slice(8,-1))&&r.constructor?r.constructor.name:t)||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}function _arrayWithHoles(r){if(Array.isArray(r))return r}document.addEventListener("DOMContentLoaded",function(){var isConfirmationView=!1,mockResponse={data:{affiliate_link:affiliateWidgetParams.affiliateLinkPreview}},widgetContainers=document.querySelectorAll(".affiliate-signup");widgetContainers.forEach(function(widgetContainer){widgetContainer.shadowReadyDispatched=!1,(widgetContainer=>{widgetContainer.shadowRoot||((shadow,widgetContainer)=>{fetch(affiliateWidgetParams.cssUrl).then(function(res){return res.text()}).then(function(css){var style=document.createElement("style"),css=(style.textContent=css,shadow.appendChild(style),document.createElement("div"));css.innerHTML=affiliateWidgetParams.widgetHtml,shadow.appendChild(css)}).then(function(){var shadowReadyEvent;widgetContainer.shadowReadyDispatched||(shadowReadyEvent=new CustomEvent("shadowReady",{detail:{shadow:shadow}}),widgetContainer.dispatchEvent(shadowReadyEvent),widgetContainer.shadowReadyDispatched=!0)})})(widgetContainer.attachShadow({mode:"open"}),widgetContainer)})(widgetContainer)});var viewToggle=document.getElementById("viewToggle");function widgetAttachFormSubmitEvent(shadow){var formInsideShadow=shadow.querySelector("form");formInsideShadow&&formInsideShadow.addEventListener("submit",function(e){e.preventDefault();e=shadow.querySelector("#signup-affiliate-preview");e&&((buttonElement,shadow)=>{(buttonElement=>{var svgSpinner=buttonElement.querySelector("svg"),originalButtonText=buttonElement.querySelector("#originalButtonText"),processingText=buttonElement.querySelector("#processingText");svgSpinner&&svgSpinner.removeAttribute("hidden"),processingText&&processingText.removeAttribute("hidden"),originalButtonText&&originalButtonText.setAttribute("hidden",!0),buttonElement.disabled=!0,buttonElement.classList.add("cursor-not-allowed")})(buttonElement),setTimeout(function(){showConfirmation(mockResponse,shadow,!0),viewToggle&&(viewToggle.checked=!0)},1e3)})(e,shadow)})}function showConfirmation(response,shadow,shouldShow){var initialView=shadow.querySelector("#initial-view"),confirmationView=shadow.querySelector("#confirmation-view"),button=shadow.querySelector("#signup-affiliate-preview");shouldShow?response&&response.data&&response.data.affiliate_link&&confirmationView&&(confirmationView.innerHTML=confirmationView.innerHTML.replace("{affiliateLink}",response.data.affiliate_link),confirmationView.style.display="block",initialView)&&(initialView.style.display="none"):(confirmationView&&(confirmationView.style.display="none"),initialView&&(initialView.style.display="block"),button&&(button=>{var svgSpinner,originalButtonText,processingText;button&&(svgSpinner=button.querySelector("svg"),originalButtonText=button.querySelector("#originalButtonText"),processingText=button.querySelector("#processingText"),svgSpinner&&svgSpinner.setAttribute("hidden",!0),processingText&&processingText.setAttribute("hidden",!0),originalButtonText&&originalButtonText.removeAttribute("hidden"),button.disabled=!1,button.classList.remove("cursor-not-allowed"))})(button)),(shadow=>{var copyLinkButton=shadow.querySelector("#copyLinkButton");copyLinkButton&&copyLinkButton.addEventListener("click",function(){(affiliateLinkInput=shadow.querySelector("#affiliateLink"))&&(affiliateLink=affiliateLinkInput.value,navigator.clipboard.writeText(affiliateLink).then(function(){affiliateLinkInput.select()}).catch(function(error){console.error("Copy failed",error)}));var affiliateLink,affiliateLinkInput,originalText=copyLinkButton.textContent;copyLinkButton.textContent=affiliateWidgetParams.data.button_copied_text,setTimeout(function(){copyLinkButton.textContent=originalText},3e3)})})(shadow)}viewToggle&&viewToggle.addEventListener("change",function(){isConfirmationView=viewToggle.checked,widgetContainers.forEach(function(widgetContainer){widgetContainer=widgetContainer.shadowRoot;widgetContainer&&showConfirmation(mockResponse,widgetContainer,isConfirmationView)})});var colorInput=document.getElementById("affwp_settings[affiliate_signup_widget_brand_color]");function generateShades(brandColor,shadow){for(var brandColorRGB=brandColor.slice(1),brandColorRGB=.2126*(parseInt(brandColorRGB.slice(0,2),16)/255)+.7152*(parseInt(brandColorRGB.slice(2,4),16)/255)+.0722*(parseInt(brandColorRGB.slice(4,6),16)/255)<.6?{100:"color-mix(in srgb, ".concat(brandColor," 15%, white 85%)"),105:"color-mix(in srgb, ".concat(brandColor," 15%, white 85%)"),110:"color-mix(in srgb, ".concat(brandColor," 60%, white 40%)"),115:"color-mix(in srgb, ".concat(brandColor," 70%, white 30%)"),120:"color-mix(in srgb, ".concat(brandColor," 10%, white 90%)"),125:"color-mix(in srgb, ".concat(brandColor," 10%, white 90%)"),130:"color-mix(in srgb, ".concat(brandColor," 10%, white 90%)"),200:"color-mix(in srgb, ".concat(brandColor," 15%, white 85%)"),205:"color-mix(in srgb, ".concat(brandColor," 15%, white 85%)"),210:"color-mix(in srgb, ".concat(brandColor," 10%, white 90%)"),215:"color-mix(in srgb, ".concat(brandColor," 10%, white 90%)"),220:"color-mix(in srgb, ".concat(brandColor," 30%, black 70%)"),225:"color-mix(in srgb, ".concat(brandColor," 10%, white 90%)"),230:"color-mix(in srgb, ".concat(brandColor," 70%, black 30%)"),235:"color-mix(in srgb, ".concat(brandColor," 90%, black 10%)"),240:"color-mix(in srgb, ".concat(brandColor," 10%, white 90%)"),300:"color-mix(in srgb, ".concat(brandColor," 10%, white 90%)"),305:"color-mix(in srgb, ".concat(brandColor," 10%, white 90%)"),500:brandColor}:{100:"color-mix(in srgb, ".concat(brandColor," 30%, black 70%)"),105:"color-mix(in srgb, ".concat(brandColor," 30%, black 70%)"),110:"color-mix(in srgb, ".concat(brandColor," 30%, black 70%)"),115:"color-mix(in srgb, ".concat(brandColor," 30%, black 70%)"),120:"color-mix(in srgb, ".concat(brandColor," 10%, white 90%)"),125:"color-mix(in srgb, ".concat(brandColor," 30%, black 70%)"),130:"color-mix(in srgb, ".concat(brandColor," 30%, black 70%)"),200:"color-mix(in srgb, ".concat(brandColor," 30%, black 70%)"),205:"color-mix(in srgb, ".concat(brandColor," 30%, black 70%)"),210:"color-mix(in srgb, ".concat(brandColor," 10%, white 90%)"),215:"color-mix(in srgb, ".concat(brandColor," 10%, white 90%)"),216:"color-mix(in srgb, ".concat(brandColor," 80%, black 20%)"),220:"color-mix(in srgb, ".concat(brandColor," 30%, black 70%)"),225:"color-mix(in srgb, ".concat(brandColor," 10%, white 90%)"),230:"color-mix(in srgb, ".concat(brandColor," 20%, black 80%)"),235:"color-mix(in srgb, ".concat(brandColor," 30%, black 70%)"),240:"color-mix(in srgb, ".concat(brandColor," 10%, white 90%)"),300:"color-mix(in srgb, ".concat(brandColor," 30%, black 70%)"),305:"color-mix(in srgb, ".concat(brandColor," 30%, black 70%)"),500:brandColor},cssVariables=":host { ",_i=0,_Object$entries=Object.entries(brandColorRGB);_i<_Object$entries.length;_i++){var _Object$entries$_i=_slicedToArray(_Object$entries[_i],2),key=_Object$entries$_i[0],_Object$entries$_i=_Object$entries$_i[1];cssVariables+="--brand-".concat(key,": ").concat(_Object$entries$_i,"; ")}cssVariables+="}";brandColor=shadow.getElementById("brand-colors");brandColor||((brandColor=document.createElement("style")).id="brand-colors",shadow.appendChild(brandColor)),brandColor.textContent=cssVariables}colorInput&&colorInput.addEventListener("input",function(event){var colorValue=event.target.value;widgetContainers.forEach(function(widgetContainer){widgetContainer=widgetContainer.shadowRoot;widgetContainer&&generateShades(colorValue,widgetContainer)})});var resetLink=document.querySelector(".affwp-reset-color-link");function attachLivePreview(inputSelector,shadowSelector,propertyToUpdate,argument_3,argument_4,argument_5){var isStyle=3<arguments.length&&void 0!==argument_3&&argument_3,isConfirmationRelated=4<arguments.length&&void 0!==argument_4&&argument_4,shadow=5<arguments.length?argument_5:void 0,argument_3=document.getElementById(inputSelector);argument_3&&(argument_4=function(e){var e=e.target.value,e=isStyle?e:e.replace(/\n/g,"<br>"),targetElement=isConfirmationView?shadow.querySelector("#confirmation-view "+shadowSelector):shadow.querySelector(shadowSelector);targetElement&&(isStyle?targetElement.style[propertyToUpdate]=e:targetElement.innerHTML=e)},argument_3._inputHandler&&argument_3.removeEventListener("input",argument_3._inputHandler),argument_3.addEventListener("input",argument_4),argument_3._inputHandler=argument_4,argument_5=function(){(isConfirmationRelated?shadow=>{viewToggle&&(viewToggle.checked=!0),showConfirmation(mockResponse,shadow,isConfirmationView=!0)}:shadow=>{viewToggle&&(viewToggle.checked=!1),showConfirmation(mockResponse,shadow,isConfirmationView=!1)})(shadow)},argument_3._focusHandler&&argument_3.removeEventListener("focus",argument_3._focusHandler),argument_3.addEventListener("focus",argument_5),argument_3._focusHandler=argument_5)}function handleShadowReady(shadow){shadow&&(widgetAttachFormSubmitEvent(shadow),attachLivePreview("affwp_settings[affiliate_signup_widget_heading_text]","h1","textContent",!1,!1,shadow),attachLivePreview("affwp_settings[affiliate_signup_widget_text]","p","textContent",!1,!1,shadow),attachLivePreview("affwp_settings[affiliate_signup_widget_button_color]","button","backgroundColor",!0,!1,shadow),attachLivePreview("affwp_settings[affiliate_signup_widget_button_text]","button","textContent",!1,!1,shadow),attachLivePreview("affwp_settings[affiliate_signup_widget_confirmation_heading_text]","h1","textContent",!1,!0,shadow),attachLivePreview("affwp_settings[affiliate_signup_widget_confirmation_text]","p","textContent",!1,!0,shadow),document.addEventListener("mediaURLChanged",function(event){((imageUrl,shadow)=>{var imageContainer,imageWrapper=shadow.querySelector("#signup-image");imageWrapper?imageContainer=imageWrapper.querySelector("div"):((imageContainer=document.createElement("div")).id="signup-image",imageContainer.className="absolute inset-0 opacity-25",imageContainer.setAttribute("aria-hidden","true"),(imageWrapper=document.createElement("div")).className="absolute inset-0 overflow-hidden",imageWrapper.setAttribute("aria-hidden","true"),imageContainer.appendChild(imageWrapper),shadow.querySelector("#widget-content").insertAdjacentElement("beforebegin",imageContainer)),(imageWrapper=imageContainer.querySelector("img"))||((imageWrapper=document.createElement("img")).alt="",imageWrapper.className="h-full w-full object-cover object-center",imageContainer.appendChild(imageWrapper)),imageWrapper.src=imageUrl})(event.detail.url,shadow)}))}resetLink&&resetLink.addEventListener("click",function(event){event.preventDefault(),widgetContainers.forEach(function(widgetContainer){widgetContainer=widgetContainer.shadowRoot;widgetContainer&&(colorInput&&(colorInput.value="#4b64e2"),generateShades("#4b64e2",widgetContainer))})}),widgetContainers.forEach(function(widgetContainer){widgetContainer.shadowReadyDispatched?handleShadowReady(widgetContainer.shadowRoot):widgetContainer.addEventListener("shadowReady",function(event){widgetContainer.shadowReadyDispatched||(widgetContainer.shadowReadyDispatched=!0,handleShadowReady(event.detail.shadow))})})});