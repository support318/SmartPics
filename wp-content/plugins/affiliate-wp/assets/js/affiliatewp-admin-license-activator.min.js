affiliatewp.attach("licenseActivator",{data:{},modal:function(title,content,icon,buttons,args){return jQuery.alert(jQuery.extend({backgroundDismiss:!0,title:title,icon:icon,type:"green",content:content,boxWidth:400,useBootstrap:!1,theme:"modern,affiliatewp-education",closeIcon:!0,draggable:!1,dragWindowBorder:!1,buttons:buttons},args))},init:function(){document.addEventListener("DOMContentLoaded",function(){var buttons=document.querySelectorAll(".affwp-settings-license-activator__button"),modalButtonArgs={confirm:{text:"OK",btnClass:"btn-confirm",keys:["enter"]}};buttons.forEach(function(button){button.addEventListener("click",function(){var targetInput=document.querySelector('input[name="'.concat(button.dataset.target,'"]')),_targetInput$value=null!=(_targetInput$value=targetInput.value)?_targetInput$value:"";if(""===_targetInput$value)affiliatewp.licenseActivator.modal("",button.dataset.invalidMessage,"fa fa-info-circle",modalButtonArgs,{closeIcon:!1,type:"orange"});else{var _key,_button$dataset$setti=JSON.parse(null!=(_button$dataset$setti=button.dataset.settingsToWatch)?_button$dataset$setti:[]),additionalData={},isActivated=(_button$dataset$setti.forEach(function(settingName){var settingInput=document.querySelector('[name="affwp_settings['.concat(settingName,']"]'));settingInput&&(additionalData[settingName]=settingInput.value)}),parseInt(null!=(_button$dataset$setti=button.dataset.isActivated)?_button$dataset$setti:0)),data={action:isActivated?button.dataset.deactivateAjaxAction:button.dataset.activateAjaxAction,key:_targetInput$value,nonce:null!=(_button$dataset$setti=affiliatewp.licenseActivator.data.nonce)?_button$dataset$setti:""};for(_key in additionalData)additionalData.hasOwnProperty(_key)&&(data["additional_data[".concat(_key,"]")]=additionalData[_key]);button.classList.add("affwp-button--is-loading");var container=null==button||null==(_targetInput$value=button.parentElement)?void 0:_targetInput$value.parentElement,statusEl=container.querySelector(".affwp-settings-license-activator__status");fetch(ajaxurl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},body:new URLSearchParams(data).toString()}).then(function(response){if(button.classList.remove("affwp-button--is-loading"),response.ok)return response.json();throw new Error("Unknown. Please try again.")}).then(function(result){var _result$data$errorMes;!isActivated&&result.success?(isActivated=1,targetInput.disabled=!0,button.textContent=button.dataset.labelActivated,affiliatewp.licenseActivator.modal("",button.dataset.activationMessage,"fa fa-check-circle",modalButtonArgs,{closeIcon:!1})):isActivated||result.success?isActivated&&result.success?(isActivated=0,targetInput.disabled=!1,button.textContent=button.dataset.labelDeactivated,affiliatewp.licenseActivator.modal("",button.dataset.deactivationMessage,"fa fa-info-circle",modalButtonArgs,{closeIcon:!1,type:"blue"})):isActivated&&!result.success&&affiliatewp.licenseActivator.modal("",button.dataset.deactivationErrorMessage,"fa fa-info-circle",modalButtonArgs,{closeIcon:!1,type:"red"}):affiliatewp.licenseActivator.modal("",null!=(_result$data$errorMes=null==result?void 0:result.data.errorMessage)?_result$data$errorMes:button.dataset.activationErrorMessage,"fa fa-info-circle",modalButtonArgs,{closeIcon:!1,type:"red"}),statusEl&&(statusEl.innerHTML=null!=(result=null==result||null==(_result$data$errorMes=result.data)?void 0:_result$data$errorMes.status)?result:""),button.setAttribute("data-is-activated",isActivated),button.dispatchEvent(new CustomEvent("affwpOnLicenseActivatorEnd",{detail:{isActivated:isActivated,success:!0,container:container}}))}).catch(function(error){error&&affiliatewp.licenseActivator.modal("",error,"fa fa-info-circle",modalButtonArgs,{closeIcon:!1,type:"red"})})}})})})}});