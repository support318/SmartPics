function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_unsupportedIterableToArray(r,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,a){var t;if(r)return"string"==typeof r?_arrayLikeToArray(r,a):"Map"===(t="Object"===(t={}.toString.call(r).slice(8,-1))&&r.constructor?r.constructor.name:t)||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}function _arrayWithHoles(r){if(Array.isArray(r))return r}affiliatewp.attach("multiCurrencySettings",{data:{},initSelect2:function($elements){$elements.each(function(){var $self=jQuery(this);$self.select2(affiliatewp.multiCurrencySettings.data.currency_select2_settings),affiliatewp.multiCurrencySettings.bindSelect2Events($self)})},bindSelect2Events:function($select2Element){affiliatewp.multiCurrencySettings.addPlaceholderToSelect2SearchInput($select2Element),affiliatewp.multiCurrencySettings.onSelect2ChangeCurrency($select2Element)},addPlaceholderToSelect2SearchInput:function($select2Element){$select2Element.one("select2:open",function(){jQuery(".select2-search__field").prop("placeholder",affiliatewp.multiCurrencySettings.data.currency_select2_settings.placeholder)})},formatExchangeRate:function(exchangeRate){return parseFloat(exchangeRate).toFixed(4)},getExchangeRate:function(currency){var _affiliatewp;return null!=(_affiliatewp=affiliatewp)&&null!=(_affiliatewp=_affiliatewp.multiCurrency)&&null!=(_affiliatewp=_affiliatewp.data)&&_affiliatewp.exchangeRates.hasOwnProperty(currency)?affiliatewp.multiCurrency.data.exchangeRates[currency]:null},onSelect2ChangeCurrency:function($select2Element){$select2Element.on("select2:select",function(){var $self=jQuery(this),$row=$self.closest(".affwp-multi-currency-row"),$self=$self.val(),exchangeRate=affiliatewp.multiCurrencySettings.getExchangeRate($self),$exchangeRateField=$row.find(".affwp-multi-currency-field-exchange-rate");$exchangeRateField.val(exchangeRate),"number"===$exchangeRateField.attr("type")&&$exchangeRateField.focus(),$row.find(".affwp-multi-currency-exchange-rate").text(affiliatewp.multiCurrencySettings.formatExchangeRate(exchangeRate)),$row.find(".affwp-multi-currency-currency").text($self)})},toggleRemoveButtonVisibility:function(){var $removeTier=jQuery(".affwp-remove-exchange-rate");2<=jQuery(".affwp-multi-currency-row").length?$removeTier.css("display","block"):$removeTier.css("display","none")},setupWooCommerceCurrencies:function(){var $addedCurrencies;window.hasOwnProperty("affiliatewpRecentCurrencies")&&!jQuery("#affwp_settings[multi_currency]").is(":checked")&&($addedCurrencies=[],jQuery('input[id="affwp_settings[multi_currency]"]').on("change",function(){var _window$affiliatewpRe;jQuery(this).is(":checked")?jQuery(null!=(_window$affiliatewpRe=window.affiliatewpRecentCurrencies)?_window$affiliatewpRe:[]).each(function(i,currency){var presentCurrencies=[];jQuery(".affwp-multi-currency-field-currency").each(function(i,select){return presentCurrencies.push(jQuery(select).val())}),presentCurrencies.includes(currency)||jQuery("#affwp-new-exchange-rate").one("click",function(){var $lastRow=jQuery(".affwp-multi-currency-row").last();$addedCurrencies.push($lastRow),jQuery(".affwp-multi-currency-field-currency",$lastRow).val(currency).trigger("select2:select").trigger("change")}).trigger("click")}):$addedCurrencies.forEach(function($row){return $row.remove()})}))},initRepeater:function(){var $root=jQuery("#affwp-multi-currency-rows"),$addNewButton=jQuery("#affwp-new-exchange-rate"),total=$root.find(".affwp-multi-currency-row").length;$addNewButton.on("click",function(e){e.preventDefault();var row,e=affiliatewp.multiCurrencySettings.getExchangeRate(affiliatewp.multiCurrencySettings.data.firstAvailableCurrencyCode),method=jQuery('select[name="affwp_settings[multi_currency_rates_update_method]"]').val(),e=jQuery((e={index:total,exchange_rate:e,exchange_rate_formatted:affiliatewp.multiCurrencySettings.formatExchangeRate(e),currency:affiliatewp.multiCurrencySettings.data.firstAvailableCurrencyCode,currency_options:""},row=affiliatewp.multiCurrencySettings.data.rowTemplate,Object.entries(e).forEach(function(_ref){var _ref=_slicedToArray(_ref,2),key=_ref[0],_ref=_ref[1];row=row.replace(new RegExp("{{\\b".concat(key,"\\b}}"),"g"),_ref)}),row));e.find(".affwp-multi-currency-exchange-rate").toggle("manual"!==method),e.find(".affwp-multi-currency-field-exchange-rate").attr("type","manual"===method?"number":"hidden"),$root.append(e),total=$root.find(".affwp-multi-currency-row").length,affiliatewp.multiCurrencySettings.initSelect2(e.find("select")),affiliatewp.multiCurrencySettings.toggleRemoveButtonVisibility(),$root.find(".affwp-multi-currency-row").find("input").focus()}),jQuery(document).on("click",".affwp-remove-exchange-rate",function(e){e.preventDefault(),jQuery(this).parent().remove(),affiliatewp.multiCurrencySettings.toggleRemoveButtonVisibility()}),affiliatewp.multiCurrencySettings.toggleRemoveButtonVisibility(),$root.find("select").each(function(){affiliatewp.multiCurrencySettings.bindSelect2Events(jQuery(this))}),jQuery(document).on("ready",this.setupWooCommerceCurrencies)}});